% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrichkegg.R
\name{enrichkegg}
\alias{enrichkegg}
\title{Perform KEGG Metabolite Enrichment Analysis}
\usage{
enrichkegg(keggid, species, pathway_data, p.adjust.method = "BH")
}
\arguments{
\item{keggid}{Character vector of metabolite KEGG IDs (e.g., c("C00022", "C00031")).
Must be in short format (without "cpd:" prefix).}

\item{species}{KEGG species code (e.g., "hsa" for human). Must match the species used
in \code{pathway_data}.}

\item{pathway_data}{Pathway data object from \code{\link{getkeggdata}}}

\item{p.adjust.method}{p-value adjustment method (default="BH"). Options: "holm", "hochberg",
"hommel", "bonferroni", "BH", "BY", "fdr".}
}
\value{
A data frame with enrichment results containing these columns:
  \item{pathwayID}{KEGG pathway ID (e.g., "hsa00010")}
  \item{Description}{Pathway description}
  \item{PathwaySize}{Total metabolites in the pathway (background set size)}
  \item{Count}{Number of significant metabolites mapped to this pathway}
  \item{MetaRatio}{Ratio of significant metabolites (format: significant/total_input)}
  \item{BgRatio}{Background ratio (format: pathway_metabolites/total_background_metabolites)}
  \item{pvalue}{Raw p-value from hypergeometric test}
  \item{p.adjust}{Adjusted p-value using specified method}
  \item{EnrichmentRatio}{Enrichment ratio calculated as (Count/PathwaySize)/(length(keggid)/length(all_background_metabolites)}
  \item{keggID}{Semicolon-separated list of metabolite IDs}
}
\description{
Conducts metabolite set enrichment analysis using KEGG pathways and hypergeometric test
}
\details{
The enrichment analysis uses the hypergeometric test with these parameters:
\deqn{p = 1 - \sum_{i=0}^{k-1} \frac{{\binom{n}{i} \binom{M-n}{N-i}}}{{\binom{M}{N}}}}
Where:
\itemize{
  \item \eqn{M}: Total metabolites in all pathways (background)
  \item \eqn{n}: Metabolites in target pathway
  \item \eqn{N}: Significant metabolites in input
  \item \eqn{k}: Overlap between pathway and significant metabolites
}
}
\note{
Only pathways with at least one significant metabolite (Count > 0) are returned.
Results are sorted by adjusted p-value in ascending order.
}
\examples{
\dontrun{
# After getting pathway data with getkeggdata()
sig_metabolites <- c("C00022", "C00031", "C00033")
enrich_results <- enrichkegg(
  keggid = sig_metabolites,
  species = "hsa",
  pathway_data = kegg_data
)

# View top 5 enriched pathways
head(enrich_results, 5)
}
}
